% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/RFplus.R
\name{RFplus}
\alias{RFplus}
\alias{RFplus.default}
\alias{RFplus.data.table}
\title{Bias Correction of Satellite Products Using Hybrid Random Forest and Quantile Mapping}
\usage{
RFplus(BD_Insitu, ...)

\method{RFplus}{default}(
  BD_Insitu,
  Cords_Insitu,
  Covariates,
  n_round = NULL,
  wet.day = FALSE,
  ntree = 2000,
  seed = 123,
  method = c("RQUANT", "QUANT", "none"),
  ratio = 15,
  save_model = FALSE,
  name_save = NULL,
  ...
)

\method{RFplus}{data.table}(
  BD_Insitu,
  Cords_Insitu,
  Covariates,
  n_round = NULL,
  wet.day = FALSE,
  ntree = 2000,
  seed = 123,
  method = c("RQUANT", "QUANT", "none"),
  ratio = 15,
  save_model = FALSE,
  name_save = NULL
)
}
\arguments{
\item{BD_Insitu}{A `data.table` with in-situ measurements containing:
- `Date`: Date of measurements (Date format)
- Columns with observed values (numeric)}

\item{...}{Additional arguments passed to methods}

\item{Cords_Insitu}{A `data.table` with station coordinates:
- `Cod`: Station ID (matching `BD_Insitu`)
- `X`: Longitude
- `Y`: Latitude}

\item{Covariates}{List of `terra::SpatRaster` objects containing:
- Satellite data layers
- Digital Elevation Model (DEM)
- Other environmental covariates}

\item{n_round}{Number of decimal places for predictions (default: NULL)}

\item{wet.day}{Logical threshold for wet-day correction or numeric value (see Note)}

\item{ntree}{Number of trees for Random Forest (default: 2000)}

\item{seed}{Random seed for reproducibility (default: 123)}

\item{method}{Distribution adjustment method: "RQUANT", "QUANT", or "none" (default: "none")}

\item{ratio}{Maximum search radius (km) for nearest station adjustment (default: 15)}

\item{save_model}{Save output as NetCDF file? (default: FALSE)}

\item{name_save}{Base name for output file (default: "Model_RFplus")}
}
\description{
Applies a three-step bias correction combining Random Forest predictions, residual correction,
and distribution adjustment using quantile mapping methods.
}
\details{
`RFplus` implements a hybrid approach:
1. **Base Prediction**: Initial Random Forest model using satellite data and covariates.
2. **Residual Correction**: Secondary Random Forest to correct residuals from step 1.
3. **Distribution Adjustment**: Quantile mapping (QUANT/RQUANT) to match observed distribution.

The final prediction combines all three steps, preserving outliers while reducing bias.
}
\note{
The `wet.day` parameter can be:
- `FALSE`: No wet-day correction
- `TRUE`: Apply correction with default threshold (0.1 mm)
- Numeric value: Custom threshold
}
